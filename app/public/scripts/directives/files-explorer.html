
<style>
    .save-file {
        color: black;
    }


    .save-file, .folder-name {
        cursor: pointer;
    }

    .file-name, folder-name {
        font-size: 15px;
    }

    .error-message {
        font-size: 15px;
    }

    .btn-edit {
        margin-bottom: 2px;
        margin-top: 2x;
    }

</style>


<div>


    <div class="row" ng-if="folderError">
       <div class="col-md-12 alert alert-danger error-message">
            <span>Invalid folder name</span>
       </div>
    </div>

    <div ng-if="uploadError">
       <div class="alert alert-danger alert-dismissible error-message"
            ng-click="cleanUploadError()" aria-label="close">
            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
            <span><strong>Uploading error!</strong><br/>
            <ul>
                <li>The file cannot be a folder (use create folder button)</li>
                <li>The file must be less than 20Mb</li>
            </ul>
            </span>
       </div>
    </div>



    <div class="row">
       <div class="col-md-3">
            <a ng-disabled="files.dir === null"
               ng-click="(fetching || files.dir === null) || goToParent()"
               class="btn btn-block btn-success">
                <span class="glyphicon glyphicon-arrow-left"></span> Parent directory
            </a>
        </div>

        <div class="col-md-3" ng-show="!creatingFolder">
            <button ng-click="creatingFolder = true"
                class="btn btn-default btn-block">
            <span class="glyphicon glyphicon-plus"></span>
            Create folder
            </button>
        </div>

        <div class="col-md-3" ng-show="creatingFolder">
            <button ng-click="creatingFolder = false"
                class="btn btn-primary btn-block">
            <span class="glyphicon glyphicon-remove"></span>
            Cancel
            </button>
        </div>


        <div class="col-md-3" ng-show="uploading">
            <button class="btn btn-danger btn-block"
                     ng-click="uploading = false">
                <span class="glyphicon glyphicon-floppy-remove"></span>
                Finish upload
            </button>
        </div>

        <div class="col-md-3" ng-show="!uploading">
            <button class="btn btn-default btn-block"
                    ng-click="uploading = true">
                <span class="glyphicon glyphicon-cloud-upload"></span>
                Upload
            </button>
        </div>

        <div class="col-md-2">
            <button ng-click="download()" class="btn btn-default btn-block">
               <span class="glyphicon glyphicon-cloud-download"></span>
               Download
            </button>
        </div>

        <div class="col-md-1" ng-show="showHidden">
            <button class="btn btn-default btn-block" ng-click="showHidden = false">
                <span class="glyphicon glyphicon-eye-open"></span>
            </button>
        </div>

        <div class="col-md-1" ng-show="!showHidden" >
            <button class="btn btn-default btn-block" ng-click="showHidden = true">
                <span class="glyphicon glyphicon-eye-close"></span>
            </button>
        </div>
    </div>

   <br/>

   <div class="row" ng-if="creatingFolder">

        <div class="col-lg-3 col-md-6 col-lg-offset-3">
           <div class="form">

                <div class="form-group">
                    <div class="input-group">
                        <input class="form-control" ng-model="folder.name"
                               type="text" placeholder="Folder"/>
                       <div class="input-group-btn">

                            <button class="btn btn-default"
                                    ng-click="createFolder()">
                                    <span class="glyphicon glyphicon-ok"></span>
                            </button>
                            <button class="btn btn-default"
                                    ng-click="cleanFolderName()">
                                    <span class="glyphicon glyphicon-remove"></span>
                            </button>

                        </div>
                    </div>
                </div>
                <div class="form-group">

                    <label class="checkbox-inline">
                            <input ng-model="folder.hidden"
                                type="checkbox" value="false"/>
                                <strong>Hidden</strong>
                    </label>
                </div>
            </div>
        </div>
    </div>

    <br/>


    <div class="table-responsive">
        <table class="table">
            <thead>
                <tr>
                    <td class="col-md-1"></td>
                    <td class="col-md-5">Name</td>
                    <td class="col-md-1">Size</td>
                    <td class="col-md-1">Download</td>
                    <td class="col-md-1">Last updated</td>
                    <td class="col-md-3">Edit</td>
                </tr>
            </thead>
            <tbody ng-repeat="file in files.files">


                <!-- Directory -->
                <tr ng-if="file.type === 'd'">

                    <!-- ICON -->
                    <td class="col-md-1">
                        <span class="fa fa-folder-open fa-lg"></span>
                    </td>

                    <!-- NAME -->
                    <td class="col-md-5">
                        <a ng-click="fileExplorer.$visible || goToRelativePath(file.name)"
                            ng-disabled="fileExplorer.$visible">
                            <span class="folder-name" editable-text="file.name"
                                  e-name="name" e-form="fileExplorer" e-required ng-bind="file.name">

                            </span>
                        </a>
                    </td>

                    <!-- SIZE (EMPTY FOR DIRECTORY) -->
                    <td class="col-md-1"></td>

                    <!-- DOWNLOAD ICON -->
                    <td class="col-md-1">
                        <a ng-click="downloadFile(file.name)">
                            <span class="fa fa-save fa-lg save-file"></span>
                        </a>
                    </td>

                    <!-- LAST UPDATED -->
                    <td class="col-md-1" am-time-ago="file.updated_at"></td>

                    <!-- EDIT -->
                    <td class="col-md-3">

                        <form editable-form name="fileExplorer" ng-show="fileExplorer.$visible"
                              class="form-buttons form-inline" onbeforesave="updateFolder($data, file.name)">

                            <div>

                                <!-- Confirm -->
                                <button type="submit" class="btn btn-primary"
                                        ng-disabled="fileExplorer.$waiting">
                                    <span class="fa fa-check fa-lg">

                                    </span>
                                </button>

                                <!-- Cancel -->
                                <button type="button" class="btn btn-warning"
                                        ng-disabled="fileExplorer.$waiting"
                                        ng-click="fileExplorer.$cancel()">
                                    <span class="fa fa-remove fa-lg">
                                    </span>
                                </button>
                            </div>
                        </form>

                        <div ng-show="!fileExplorer.$visible">

                            <!-- Edit -->
                            <button class="btn btn-default" ng-click="fileExplorer.$show()">
                                <span class="fa fa-pencil-square-o fa-lg">
                                </span>
                            </button>

                            <!-- Delete -->
                            <button class="btn btn-danger" ng-click="removeFile($index)">
                                <span class="fa fa-minus fa-lg">
                                </span>
                            </button>
                        </div>

                    </td>
                </tr>


                <!-- File -->
                <tr ng-if="file.type === 'f'">

                    <!-- ICON -->
                    <td class="col-md-1">
                        <span file-icon ext="file.ext"></span></file-icon>
                    </td>

                    <!-- NAME -->
                    <td class="col-md-5 file-name">{{file.name}}</td>

                    <!-- SIZE -->
                    <td class="col-md-1">{{file.size | byteFmt: 2}} </td>

                    <!-- DOWNLOAD ICON -->
                    <td class="col-md-1">
                        <a ng-click="downloadFile(file.name)">
                            <span class="fa fa-save fa-lg save-file"></span>
                        </a>
                    </td>

                    <!-- LAST UPDATED -->
                    <td class="col-md-1" am-time-ago="file.updated_at"></td>
                    <td class="col-md-3">
                        <button class="btn btn-danger" ng-click="removeFile($index)">
                                <span class="fa fa-minus fa-lg">
                                </span>
                        </button>
                    </td>
                </tr>
            </tbody>


        </table>
    </div>

    <upload ng-if="uploading" path="getUploadPath()"></upload>

</div>
